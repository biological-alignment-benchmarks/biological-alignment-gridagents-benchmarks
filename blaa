python -m pytest --tb=native --cov=aintelope tests
============================= test session starts ==============================
platform linux -- Python 3.10.3, pytest-7.1.2, pluggy-1.0.0
rootdir: /home/joel/project/aintelope
plugins: hydra-core-1.3.0, cov-3.0.0
collected 70 items

tests/agents/test_instinct_agent.py FF                                   [  2%]
tests/agents/test_q_agent.py FF                                          [  5%]
tests/agents/test_simple_agents_sequential.py FFFFFF                     [ 14%]
tests/environments/test_savanna.py .....                                 [ 21%]
tests/environments/test_savanna_safetygrid_parallel.py .............     [ 40%]
tests/environments/test_savanna_safetygrid_sequential.py .............   [ 58%]
tests/environments/test_savanna_zoo_parallel.py .......F.....            [ 77%]
tests/environments/test_savanna_zoo_sequential.py .......F.....          [ 95%]
tests/training/test_trainer.py FFF                                       [100%]

=================================== FAILURES ===================================
_________________ test_instinctagent_in_savanna_zoo_sequential _________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_instinct_agent.py", line 33, in test_instinctagent_in_savanna_zoo_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_____________ test_instinctagent_in_savanna_gridworlds_sequential ______________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_instinct_agent.py", line 54, in test_instinctagent_in_savanna_gridworlds_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
____________________ test_qagent_in_savanna_zoo_sequential _____________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_q_agent.py", line 35, in test_qagent_in_savanna_zoo_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_________________ test_qagent_in_savanna_gridworlds_sequential _________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_q_agent.py", line 57, in test_qagent_in_savanna_gridworlds_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
________________ test_randomwalkagent_in_savanna_zoo_sequential ________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 34, in test_randomwalkagent_in_savanna_zoo_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_________ test_onestepperfectpredictionagent_in_savanna_zoo_sequential _________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 60, in test_onestepperfectpredictionagent_in_savanna_zoo_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_______ test_iterativeweightoptimizationagent_in_savanna_zoo_sequential ________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 86, in test_iterativeweightoptimizationagent_in_savanna_zoo_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
____________ test_randomwalkagent_in_savanna_gridworlds_sequential _____________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 110, in test_randomwalkagent_in_savanna_gridworlds_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_____ test_onestepperfectpredictionagent_in_savanna_gridworlds_sequential ______
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 136, in test_onestepperfectpredictionagent_in_savanna_gridworlds_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
____ test_iterativeweightoptimizationagent_in_savanna_gridworlds_sequential ____
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/agents/test_simple_agents_sequential.py", line 162, in test_iterativeweightoptimizationagent_in_savanna_gridworlds_sequential
    run_episode(full_params=full_params)
  File "/home/joel/project/aintelope/aintelope/training/simple_eval.py", line 151, in run_episode
    trainer.add_agent(agent.id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_______________________________ test_zoo_agents ________________________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/environments/test_savanna_zoo_parallel.py", line 172, in test_zoo_agents
    assert isinstance(env.unwrapped.agent_name_mapping, dict)
AttributeError: 'SavannaZooParallelEnv' object has no attribute 'agent_name_mapping'
_______________________________ test_zoo_agents ________________________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/environments/test_savanna_zoo_sequential.py", line 174, in test_zoo_agents
    assert isinstance(env.unwrapped.agent_name_mapping, dict)
AttributeError: 'SavannaZooSequentialEnv' object has no attribute 'agent_name_mapping'
_________________________ test_training_pipeline_main __________________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/training/test_trainer.py", line 18, in test_training_pipeline_main
    assert ret.returncode == 0, "Trainer from __main__ caused an error!"
AssertionError: Trainer from __main__ caused an error!
assert 1 == 0
 +  where 1 = CompletedProcess(args=['python', '-m', 'aintelope'], returncode=1).returncode
----------------------------- Captured stdout call -----------------------------
[2023-12-16 18:24:11,912][aintelope.__main__][INFO] - Running training with the following configuration
[2023-12-16 18:24:11,918][aintelope.__main__][INFO] - timestamp: ${now:%Y%m%d%H%M%S}
experiment_name: hunger
experiment_dir: outputs/${experiment_name}_${timestamp}/
trainer_params:
  resume_from_checkpoint: false
  num_workers: 4
  max_epochs: 10
  checkpoint: ${experiment_dir}/checkpoints/
  device: cpu
  verbose: false
hparams:
  batch_size: 16
  lr: 0.001
  env: savanna-zoo-sequential-v2
  env_entry_point: aintelope.environments.savanna_zoo:SavannaZooSequentialEnv
  env_type: zoo
  model: dqn
  agent_id: q_agent
  gamma: 0.99
  sync_rate: 10
  replay_size: 99
  eps_last_frame: 1000
  eps_start: 1.0
  eps_end: 0.01
  tau: 0.05
  num_episodes: 10
  episode_length: 1010
  warm_start_steps: 100
  log_figures_every_n_epochs: 5
  every_n_episodes: 1
  env_params:
    num_iters: 200
    map_min: 0
    map_max: 5
    render_mode: null
    render_map_max: 5
    amount_agents: 1
    amount_grass_patches: 1
    amount_water_holes: 0
  agent_params:
    target_instincts: []

[2023-12-16 18:24:11,919][aintelope.environments.savanna][INFO] - initializing savanna env with params: {'render.modes': ['human', 'ansi', 'rgb_array'], 'name': 'savanna-v2', 'render_agent_radius': 5, 'render_agent_color': (200, 50, 0), 'render_grass_radius': 5, 'render_grass_color': (20, 200, 0), 'render_modes': ('human', 'ascii', 'offline'), 'render_window_size': 512, 'amount_agents': 1, 'map_min': 0, 'map_max': 5, 'amount_grass_patches': 1, 'amount_water_holes': 0, 'num_iters': 200, 'render_mode': None, 'render_map_max': 5}
----------------------------- Captured stderr call -----------------------------
/home/joel/project/aintelope/aintelope/config/config_utils.py:12: UserWarning: register_resolver() is deprecated.
See https://github.com/omry/omegaconf/issues/426 for migration instructions.

  OmegaConf.register_resolver("abs_path", get_project_path)
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 23, in <module>
    aintelope_main()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/main.py", line 90, in decorated_main
    _run_hydra(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 222, in run_and_report
    raise ex
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 219, in run_and_report
    return func()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 18, in aintelope_main
    run_experiment(cfg)
  File "/home/joel/project/aintelope/aintelope/experiments.py", line 61, in run_experiment
    trainer.add_agent(agent_id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
_______________________ test_training_pipeline_baseline ________________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/training/test_trainer.py", line 35, in test_training_pipeline_baseline
    assert ret.returncode == 0, "Trainer baseline caused an error!"
AssertionError: Trainer baseline caused an error!
assert 2 == 0
 +  where 2 = CompletedProcess(args=['make', 'run-training-baseline'], returncode=2).returncode
----------------------------- Captured stdout call -----------------------------
make[1]: Entering directory '/home/joel/project/aintelope'
python -m aintelope hparams.agent_id=q_agent hparams.agent_params.target_instincts=[]
[2023-12-16 18:24:15,518][aintelope.__main__][INFO] - Running training with the following configuration
[2023-12-16 18:24:15,525][aintelope.__main__][INFO] - timestamp: ${now:%Y%m%d%H%M%S}
experiment_name: hunger
experiment_dir: outputs/${experiment_name}_${timestamp}/
trainer_params:
  resume_from_checkpoint: false
  num_workers: 4
  max_epochs: 10
  checkpoint: ${experiment_dir}/checkpoints/
  device: cpu
  verbose: false
hparams:
  batch_size: 16
  lr: 0.001
  env: savanna-zoo-sequential-v2
  env_entry_point: aintelope.environments.savanna_zoo:SavannaZooSequentialEnv
  env_type: zoo
  model: dqn
  agent_id: q_agent
  gamma: 0.99
  sync_rate: 10
  replay_size: 99
  eps_last_frame: 1000
  eps_start: 1.0
  eps_end: 0.01
  tau: 0.05
  num_episodes: 10
  episode_length: 1010
  warm_start_steps: 100
  log_figures_every_n_epochs: 5
  every_n_episodes: 1
  env_params:
    num_iters: 200
    map_min: 0
    map_max: 5
    render_mode: null
    render_map_max: 5
    amount_agents: 1
    amount_grass_patches: 1
    amount_water_holes: 0
  agent_params:
    target_instincts: []

[2023-12-16 18:24:15,526][aintelope.environments.savanna][INFO] - initializing savanna env with params: {'render.modes': ['human', 'ansi', 'rgb_array'], 'name': 'savanna-v2', 'render_agent_radius': 5, 'render_agent_color': (200, 50, 0), 'render_grass_radius': 5, 'render_grass_color': (20, 200, 0), 'render_modes': ('human', 'ascii', 'offline'), 'render_window_size': 512, 'amount_agents': 1, 'map_min': 0, 'map_max': 5, 'amount_grass_patches': 1, 'amount_water_holes': 0, 'num_iters': 200, 'render_mode': None, 'render_map_max': 5}
make[1]: Leaving directory '/home/joel/project/aintelope'
----------------------------- Captured stderr call -----------------------------
/home/joel/project/aintelope/aintelope/config/config_utils.py:12: UserWarning: register_resolver() is deprecated.
See https://github.com/omry/omegaconf/issues/426 for migration instructions.

  OmegaConf.register_resolver("abs_path", get_project_path)
Error executing job with overrides: ['hparams.agent_id=q_agent', 'hparams.agent_params.target_instincts=[]']
Traceback (most recent call last):
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 23, in <module>
    aintelope_main()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/main.py", line 90, in decorated_main
    _run_hydra(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 222, in run_and_report
    raise ex
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 219, in run_and_report
    return func()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 18, in aintelope_main
    run_experiment(cfg)
  File "/home/joel/project/aintelope/aintelope/experiments.py", line 61, in run_experiment
    trainer.add_agent(agent_id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
make[1]: *** [Makefile:7: run-training-baseline] Error 1
_______________________ test_training_pipeline_instinct ________________________
Traceback (most recent call last):
  File "/home/joel/project/aintelope/tests/training/test_trainer.py", line 52, in test_training_pipeline_instinct
    assert ret.returncode == 0, "Trainer baseline caused an error!"
AssertionError: Trainer baseline caused an error!
assert 2 == 0
 +  where 2 = CompletedProcess(args=['make', 'run-training-instinct'], returncode=2).returncode
----------------------------- Captured stdout call -----------------------------
make[1]: Entering directory '/home/joel/project/aintelope'
python -m aintelope hparams.agent_id=instinct_agent hparams.agent_params.target_instincts=[smell]
[2023-12-16 18:24:19,062][aintelope.__main__][INFO] - Running training with the following configuration
[2023-12-16 18:24:19,068][aintelope.__main__][INFO] - timestamp: ${now:%Y%m%d%H%M%S}
experiment_name: hunger
experiment_dir: outputs/${experiment_name}_${timestamp}/
trainer_params:
  resume_from_checkpoint: false
  num_workers: 4
  max_epochs: 10
  checkpoint: ${experiment_dir}/checkpoints/
  device: cpu
  verbose: false
hparams:
  batch_size: 16
  lr: 0.001
  env: savanna-zoo-sequential-v2
  env_entry_point: aintelope.environments.savanna_zoo:SavannaZooSequentialEnv
  env_type: zoo
  model: dqn
  agent_id: instinct_agent
  gamma: 0.99
  sync_rate: 10
  replay_size: 99
  eps_last_frame: 1000
  eps_start: 1.0
  eps_end: 0.01
  tau: 0.05
  num_episodes: 10
  episode_length: 1010
  warm_start_steps: 100
  log_figures_every_n_epochs: 5
  every_n_episodes: 1
  env_params:
    num_iters: 200
    map_min: 0
    map_max: 5
    render_mode: null
    render_map_max: 5
    amount_agents: 1
    amount_grass_patches: 1
    amount_water_holes: 0
  agent_params:
    target_instincts:
    - smell

[2023-12-16 18:24:19,069][aintelope.environments.savanna][INFO] - initializing savanna env with params: {'render.modes': ['human', 'ansi', 'rgb_array'], 'name': 'savanna-v2', 'render_agent_radius': 5, 'render_agent_color': (200, 50, 0), 'render_grass_radius': 5, 'render_grass_color': (20, 200, 0), 'render_modes': ('human', 'ascii', 'offline'), 'render_window_size': 512, 'amount_agents': 1, 'map_min': 0, 'map_max': 5, 'amount_grass_patches': 1, 'amount_water_holes': 0, 'num_iters': 200, 'render_mode': None, 'render_map_max': 5}
make[1]: Leaving directory '/home/joel/project/aintelope'
----------------------------- Captured stderr call -----------------------------
/home/joel/project/aintelope/aintelope/config/config_utils.py:12: UserWarning: register_resolver() is deprecated.
See https://github.com/omry/omegaconf/issues/426 for migration instructions.

  OmegaConf.register_resolver("abs_path", get_project_path)
Error executing job with overrides: ['hparams.agent_id=instinct_agent', 'hparams.agent_params.target_instincts=[smell]']
Traceback (most recent call last):
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/joel/.pyenv/versions/3.10.3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 23, in <module>
    aintelope_main()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/main.py", line 90, in decorated_main
    _run_hydra(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 222, in run_and_report
    raise ex
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 219, in run_and_report
    return func()
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/joel/project/aintelope/aintelope/__main__.py", line 18, in aintelope_main
    run_experiment(cfg)
  File "/home/joel/project/aintelope/aintelope/experiments.py", line 61, in run_experiment
    trainer.add_agent(agent_id, observation.shape, env.action_space)
  File "/home/joel/project/aintelope/aintelope/training/dqn_training.py", line 104, in add_agent
    self.n_observations, self.action_spaces(agent_id).n
TypeError: 'dict' object is not callable
make[1]: *** [Makefile:10: run-training-instinct] Error 1
=============================== warnings summary ===============================
tests/environments/test_savanna_safetygrid_sequential.py::test_gridworlds_api_sequential
  /home/joel/project/aintelope/venv_aintelope/lib/python3.10/site-packages/pettingzoo/test/api_test.py:248: UserWarning: Action space for each agent probably should be gymnasium.spaces.box or gymnasium.spaces.discrete
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.10.3-final-0 -----------
Name                                               Stmts   Miss  Cover
----------------------------------------------------------------------
aintelope/__init__.py                                  0      0   100%
aintelope/__main__.py                                 15      0   100%
aintelope/agents/__init__.py                          26      5    81%
aintelope/agents/instinct_agent.py                    56     27    52%
aintelope/agents/instincts/savanna_instincts.py       84     60    29%
aintelope/agents/q_agent.py                           90     50    44%
aintelope/agents/simple_agents.py                     92     72    22%
aintelope/config/__init__.py                           0      0   100%
aintelope/config/config_utils.py                       7      2    71%
aintelope/environments/__init__.py                    17      2    88%
aintelope/environments/env_utils/distance.py          10      0   100%
aintelope/environments/env_utils/render_ascii.py      59     46    22%
aintelope/environments/savanna.py                    174     62    64%
aintelope/environments/savanna_gym.py                 42     24    43%
aintelope/environments/savanna_safetygrid.py         251    103    59%
aintelope/environments/savanna_zoo.py                 73      0   100%
aintelope/environments/typing.py                      10      0   100%
aintelope/experiments.py                              85     56    34%
aintelope/models/dqn.py                                7      1    86%
aintelope/training/dqn_training.py                   109     68    38%
aintelope/training/simple_eval.py                    111     60    46%
----------------------------------------------------------------------
TOTAL                                               1318    638    52%

=========================== short test summary info ============================
FAILED tests/agents/test_instinct_agent.py::test_instinctagent_in_savanna_zoo_sequential
FAILED tests/agents/test_instinct_agent.py::test_instinctagent_in_savanna_gridworlds_sequential
FAILED tests/agents/test_q_agent.py::test_qagent_in_savanna_zoo_sequential - ...
FAILED tests/agents/test_q_agent.py::test_qagent_in_savanna_gridworlds_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_randomwalkagent_in_savanna_zoo_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_onestepperfectpredictionagent_in_savanna_zoo_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_iterativeweightoptimizationagent_in_savanna_zoo_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_randomwalkagent_in_savanna_gridworlds_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_onestepperfectpredictionagent_in_savanna_gridworlds_sequential
FAILED tests/agents/test_simple_agents_sequential.py::test_iterativeweightoptimizationagent_in_savanna_gridworlds_sequential
FAILED tests/environments/test_savanna_zoo_parallel.py::test_zoo_agents - Att...
FAILED tests/environments/test_savanna_zoo_sequential.py::test_zoo_agents - A...
FAILED tests/training/test_trainer.py::test_training_pipeline_main - Assertio...
FAILED tests/training/test_trainer.py::test_training_pipeline_baseline - Asse...
FAILED tests/training/test_trainer.py::test_training_pipeline_instinct - Asse...
================== 15 failed, 55 passed, 1 warning in 18.99s ===================
